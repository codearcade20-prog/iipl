.modalOverlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 3000;
    backdrop-filter: blur(5px);
    padding: 20px;
}

.modalContent {
    background: #525659;
    width: 100%;
    max-width: 900px;
    height: 90vh;
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    position: relative;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
}

.modalHeader {
    background: white;
    padding: 12px 20px;
    border-bottom: 1px solid #e2e8f0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modalTitle {
    margin: 0;
    font-size: 1.1rem;
    font-weight: 600;
    color: #1e293b;
}

.closeBtn {
    background: #f1f5f9;
    border: none;
    border-radius: 8px;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 1.2rem;
    color: #64748b;
    transition: all 0.2s;
}

.closeBtn:hover {
    background: #e2e8f0;
    color: #0f172a;
}

.printBtn {
    background: #0ea5e9;
    color: white;
    border: none;
    border-radius: 8px;
    padding: 0 16px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 0.9rem;
    font-weight: 600;
    gap: 8px;
    transition: all 0.2s;
}

.printBtn:hover {
    background: #0284c7;
    transform: translateY(-1px);
}

.previewBody {
    flex: 1;
    overflow-y: auto;
    padding: 40px 20px;
    display: flex;
    justify-content: center;
    align-items: flex-start;
}

/* Shared Preview Styles (copied/adapted from Generator modules) */

.invoicePaper {
    width: 210mm;
    min-height: fit-content;
    background: white;
    padding: 15mm;
    box-sizing: border-box;
    color: #000;
    font-family: 'Outfit', sans-serif;
}

.borderBox {
    border: 1px solid #000;
}

.headerTitle {
    text-align: center;
    font-weight: bold;
    padding: 5px;
    font-size: 13pt;
    border-bottom: 1px solid #000;
}

.vendorDetails {
    text-align: center;
    padding: 10px;
    border-bottom: 1px solid #000;
}

.previewVendorName {
    color: #1a56db;
    /* Fallback for primary */
    font-size: 22pt;
    font-weight: bold;
    margin: 10px 0 5px 0;
}

.panNo {
    text-align: right;
    font-size: 10pt;
    font-weight: bold;
    margin-bottom: 5px;
}

.infoGrid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-bottom: 1px solid #000;
}

.infoItem {
    padding: 5px 10px;
    font-size: 10pt;
}

.toSection {
    padding: 5px 10px 0 10px;
    font-weight: bold;
}

.clientName {
    padding: 0 10px 5px 10px;
    font-weight: bold;
    font-size: 10pt;
}

.projectName {
    text-align: center;
    font-weight: bold;
    padding: 8px;
    border-top: 1px solid #000;
    border-bottom: 1px solid #000;
    font-size: 11pt;
    text-transform: uppercase;
}

.previewTable {
    width: 100%;
    border-collapse: collapse;
}

.previewTable th,
.previewTable td {
    border: 1px solid #000;
    padding: 8px 10px;
    text-align: center;
    font-size: 10pt;
}

.descCol {
    text-align: left !important;
    width: 50%;
    white-space: pre-wrap;
}

.amountCol {
    text-align: right;
}

.wordsSection {
    padding: 10px;
    text-align: center;
    font-weight: bold;
    border-top: 1px solid #000;
    border-bottom: 1px solid #000;
    font-size: 10pt;
}

.bankDetails {
    margin-top: 15px;
    line-height: 1.5;
    font-size: 10pt;
    font-weight: bold;
}

.footerSig {
    margin-top: 10px;
    text-align: right;
    font-weight: bold;
}

.invoiceFooterArea {
    padding: 15px;
    position: relative;
    min-height: 100px;
}

.gmInvoiceSigOverlay {
    position: absolute;
    left: 45%;
    top: 50%;
    transform: translateY(-50%);
    z-index: 10;
    pointer-events: none;
}

.gmInvoiceSigOverlay img,
.gmPaymentSigOverlay img {
    max-height: 120px;
    max-width: 250px;
}

.signatureContainer {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 45px;
}

.signatureImg {
    max-height: 650px;
    max-width: 150px;
    object-fit: contain;
}

/* Payment Request Specific */
.gridTable {
    width: 100%;
    border-collapse: collapse;
    border: 2px solid #000;
}

.gridTable td {
    border: 1px solid #000;
    padding: 12px;
    font-size: 11pt;
}

.headerRow {
    background-color: #e3effb;
    text-align: center;
    font-weight: bold;
    font-size: 14pt;
}

.labelCell {
    width: 30%;
    font-weight: bold;
    text-transform: uppercase;
    font-size: 10pt;
}

.billStatusContainer {
    display: flex;
    width: 100%;
}

.statusBox {
    flex: 1;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
}

.rupeesSection {
    background-color: #f2f2f2;
    border: 2px solid #000;
    border-top: none;
    padding-bottom: 40px;
    position: relative;
}

.gmPaymentSigOverlay {
    position: absolute;
    left: 41%;
    bottom: -50px;
    z-index: 10;
    pointer-events: none;
    transform: translateX(-50%);
}

.rupeesValue {
    min-height: 60px;
    padding: 20px;
    text-align: center;
    font-weight: bold;
    font-size: 13pt;
}

.footerGrid {
    display: grid;
    grid-template-columns: 1.25fr 1fr 1fr 1fr;
    background-color: #f2f2f2;
    border: 2px solid #000;
    border-top: none;
}

.footerItem {
    border-right: 1px solid #000;
    padding: 15px 5px;
    text-align: center;
    font-weight: bold;
    font-size: 11pt;
    text-transform: uppercase;
}

.footerItem:last-child {
    border-right: none;
}

@media print {
    /* 
       PORTAL FIX & LAYOUT POLISH:
       1. Hide main app (#root) ONLY when printing from TemplateModal.
       2. Enforce PURE WHITE background globally using :global() to escape CSS Module scoping.
       3. Scale content slightly to fit A4 vertical space.
       
       IMPORTANT: These styles only apply when .template-modal-print is present in the DOM.
       This prevents breaking print functionality on InvoiceGenerator and PaymentRequest pages.
    */

    /* Only hide #root when printing from TemplateModal (identified by template-modal-print class) */
    :global(.template-modal-print)~ :global(#root),
    :global(body:has(.template-modal-print)) :global(#root) {
        display: none !important;
    }

    :global(body),
    :global(html) {
        width: 100% !important;
        height: 100% !important;
        overflow: visible !important;
        background-color: white !important;
        /* Overrides any gradients */
        background-image: none !important;
        margin: 0 !important;
        padding: 0 !important;
    }

    /* Reset the Modal Wrappers to be invisible */
    .modalOverlay,
    .modalContent,
    .previewBody {
        position: absolute !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: auto !important;
        margin: 0 !important;
        padding: 0 !important;
        background: transparent !important;
        box-shadow: none !important;
        border: none !important;
        border-radius: 0 !important;
        /* Prevent corner clipping */
        overflow: visible !important;
        display: block !important;
        z-index: 99999 !important;
    }

    /* Make the portal content visible and positioned */
    :global(.printable-content),
    :global(.printable-content) * {
        visibility: visible !important;
    }

    :global(.printable-content) {
        position: absolute !important;
        top: 0 !important;
        left: 0 !important;
        width: 105% !important;
        /* Compensate for scale down */
        margin: 0 !important;
        padding: 0 !important;
        box-shadow: none !important;
        background: white !important;
        transform: scale(0.95);
        /* Fit content nicely */
        transform-origin: top left;
        min-height: 100vh;
        /* Ensure white bg extends to bottom */
    }

    /* Hide UI controls */
    .modalHeader,
    .printBtn,
    .closeBtn,
    .footerSigSection {
        display: none !important;
    }

    @page {
        size: A4;
        margin: 10mm;
    }
}